<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Top 10 Visitor Countries</title>

<style>
body{
  margin:0;
  font-family: system-ui, Arial, sans-serif;
  background:#eef5ff;
  display:flex;
  justify-content:center;
  padding-top:50px;
}

.card{
  background:white;
  width:360px;
  border-radius:20px;
  padding:20px;
  box-shadow:0 15px 35px rgba(0,0,0,.15);
}

h1{
  text-align:center;
  font-size:24px;
  margin:0;
}

.meta{
  text-align:center;
  color:#666;
  font-size:13px;
  margin:6px 0 14px;
}

.header{
  display:flex;
  background:linear-gradient(90deg,#2ad1ff,#3b9dff);
  color:white;
  border-radius:10px;
  overflow:hidden;
  font-weight:600;
}

.header div{
  padding:8px;
  text-align:center;
}

.header .rank{width:40px}
.header .country{flex:1}
.header .visits{width:90px}

.row{
  display:flex;
  border-bottom:1px solid #eee;
  padding:7px 0;
}

.row:last-child{border:none}

.row div{
  text-align:center;
}

.row .rank{width:40px}
.row .country{flex:1}
.row .visits{width:90px;font-weight:600}

.loading{
  text-align:center;
  padding:20px;
  color:#777;
}

.error{
  color:red;
  text-align:center;
  padding:20px;
}
</style>
</head>

<body>

<div class="card">
  <h1>üåç TOP 10 Visitor Countries</h1>
  <div class="meta">Last 28 days ‚Ä¢ sessions</div>

  <div class="header">
    <div class="rank">#</div>
    <div class="country">Country</div>
    <div class="visits">Visits</div>
  </div>

  <div id="list" class="loading">Loading data...</div>
</div>

<script>
const DATA_URL = "/top-country-stats/public/data/top-countries.json";

async function loadData(){
  try{
    const res = await fetch(DATA_URL);
    if(!res.ok) throw new Error("Fetch failed");

    const data = await res.json();

    // support both formats
    const rows = Array.isArray(data) ? data : (data.rows || []);

    if(!rows.length){
      document.getElementById("list").innerHTML =
        "<div class='error'>No data found</div>";
      return;
    }

    let html = "";

    rows.slice(0,10).forEach((item,i)=>{
      const country = item.country || item.name || "Unknown";
      const visits = item.visits || item.value || 0;

      html += `
        <div class="row">
          <div class="rank">${i+1}</div>
          <div class="country">${country}</div>
          <div class="visits">${visits}</div>
        </div>
      `;
    });

    document.getElementById("list").innerHTML = html;

  }catch(err){
    document.getElementById("list").innerHTML =
      "<div class='error'>Failed to load GA4 data</div>";
    console.error(err);
  }
}

loadData();
</script>

</body>
</html>
